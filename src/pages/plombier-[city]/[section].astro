---
import Layout from "../../layouts/Layout.astro";
import Hero from "../../components/homepage/Hero.astro";
import { data } from "../../data/locations";        

import SectionServices from '../../components/section/SectionServices.astro';
import SectionParticularites from '../../components/section/SectionParticularities.astro';
import SectionUrgence from '../../components/section/SectionUrgence.astro';
import SectionTestimonials from '../../components/section/SectionTestimonials.astro';
import SectionFAQ from '../../components/section/SectionFAQ.astro';
import SectionTips from '../../components/section/SectionTips.astro';
import SectionConclusion from '../../components/section/SectionConclusion.astro';
import { generateSchema } from "../../seo/schema";

export function getStaticPaths() {
    const paths = [];

    data.forEach(stateObject => {
        if (stateObject.Cities && Array.isArray(stateObject.Cities)) {
            stateObject.Cities.forEach(cityObject => {
                // We only care about cities that *have* sections for this file
                if (cityObject.sections && Array.isArray(cityObject.sections) && cityObject.slug) {
                    cityObject.sections.forEach(sectionObject => {
                        // Ensure the section has a slug and name
                        if (sectionObject.slug && sectionObject.name) {
                             paths.push({
                                params: { 
                                    city: cityObject.slug,      // Param for the folder name [city]
                                    section: sectionObject.slug // Param for the file name [section]
                                }, 
                                props: { // Props remain the same as before
                                    sectionName: sectionObject.name, 
                                    parentCityName: cityObject.cityName, 
                                    stateName: stateObject.State,       
                                    codePostal: sectionObject.codePostal || cityObject.codePostal || '' 
                                }
                            });
                        }
                    });
                }
            });
        }
    });

    return paths;
}

// Get props passed from getStaticPaths
const { sectionName, parentCityName, stateName, codePostal } = Astro.props;

// Define Hero Data for the section page
const heroData = {
  title: `Plombier ${sectionName} ${codePostal} - Intervention Rapide et Qualité`,
  subtitle: `Vous recherchez un plombier de confiance à ${sectionName}? Notre équipe de plombiers qualifiés intervient rapidement dans tout le quartier ${sectionName} pour tous vos besoins en plomberie. Spécialistes du débouchage, de la réparation de fuites et de l'installation sanitaire, nous sommes à votre service 24h/24 et 7j/7 pour résoudre efficacement vos problèmes de plomberie.\nGrâce à notre excellente connaissance du quartier ${sectionName} de ${parentCityName} et de ses spécificités, nous vous garantissons une intervention adaptée et rapide, quel que soit votre problème de plomberie.`, // Full subtitle
  backgroundImageUrl: "/plombier-professionnel-belgique.webp", // Adjust path or use different image
};

const meta_title = `Plombier ${sectionName} en urgence ⭐️ 24/7`;
const meta_description = `Plombier professionnel à ${sectionName} ⭐️ réparation fuites, installations sanitaires. Intervention urgente 24h/24 et 7j/7. Devis gratuit ☎️ 0476/23.23.23.`;
const schemaMarkup = generateSchema(meta_title, meta_description, 21);
---

<Layout meta_title={meta_title} meta_description={meta_description} schemaMarkup={schemaMarkup}>
    <Hero heroData={heroData} />
    <SectionServices sectionName={sectionName} parentCityName={parentCityName} />
    <SectionParticularites sectionName={sectionName} />
    <SectionUrgence sectionName={sectionName} parentCityName={parentCityName} />
    <SectionTestimonials sectionName={sectionName} parentCityName={parentCityName} />
    <SectionFAQ sectionName={sectionName} parentCityName={parentCityName} />
    <SectionTips sectionName={sectionName} />
    <section class="bg-blue-700 text-white py-12 md:py-16">
        <div class="container mx-auto px-4 max-w-4xl text-center">
            <h2 class="text-2xl md:text-3xl font-bold mb-6">
                Conclusion - Votre Plombier de proximité à {sectionName} - {parentCityName} 
            </h2>
            <div class="space-y-4 text-blue-100 mb-8">
                <p>
                    Notre équipe de <strong>plombiers professionnels</strong> connaît parfaitement la section (localité)
                    <strong>{sectionName} </strong>de la commune de {parentCityName}. Cette proximité nous permet d'intervenir rapidement
                    et efficacement pour tous vos besoins en plomberie, en débouchage et en chauffage.
                </p>
                <p class="font-semibold text-white">
                    N'hésitez pas à nous contacter pour bénéficier de notre expertise locale et obtenir un service de
                    plomberie de qualité, adapté aux spécificités de votre quartier.
                </p>
            </div>
            <div class="pt-4">
                <a href="tel:+32476232323" title="Téléphone de Assur Plombier"
                    class="bg-white text-blue-700 hover:bg-gray-100 font-bold py-3 px-8 rounded-full inline-flex items-center justify-center transition-colors duration-300 shadow-md text-lg">
                    0476/23.23.23
                </a>
            </div>
        </div>
    </section>
</Layout>